{"version":3,"sources":["../src/ctrl.js"],"names":["MetricsPanelCtrl","$","angular","kbn","FileExport","DataTable","transformDataToTable","transformers","DatatableRenderer","panelDefaults","targets","transform","rowsPerPage","showHeader","styles","type","pattern","dateFormat","unit","decimals","colors","colorMode","thresholds","columns","groupBy","splitColumn","splitChar","scroll","scrollHeight","fontSize","sort","col","desc","sortDirection","datatableTheme","themeOptions","light","dark","rowNumbersEnabled","infoEnabled","searchEnabled","showCellBorders","showRowBorders","hoverEnabled","orderColumnEnabled","compactRowsEnabled","stripedRowsEnabled","lengthChangeEnabled","datatablePagingType","pagingTypes","text","value","themes","disabled","responsive","enable","hiddenColumns","editor","create","edit","editSingle","remove","removeSingle","buttons","collection","columnsToggle","columnsVisibility","columnToggle","columnVisibility","colvis","colvisGroup","colvisRestore","copy","copyHtml5","print","pageLength","csv","csvHtml5","excel","excelHtml5","pdf","pdfHtml5","selectAll","selectNone","selectCells","selectColumns","selectRows","DatatablePanelCtrl","$scope","$injector","$http","$location","uiSegmentSrv","annotationsSrv","pageIndex","table","dataRaw","addColumnSegment","newPlusButton","addGroupBySegment","addSplitSegment","addHiddenColumnBySegment","fontSizes","colorModes","columnTypes","unitFormats","getUnitFormats","dateFormats","sortDirections","getColumnNames","_","map","panel","fields","defaults","System","config","paths","getPanelPath","import","grafanaBootData","user","lightTheme","dataLoaded","http","events","on","onDataReceived","bind","onDataError","onInitEditMode","onInitPanelActions","actions","push","click","panels","settings","thisPanel","pluginId","thisPanelPath","baseUrl","optionsPath","addEditorTab","datatableOptionsPath","datasource","setTimeQueryStart","getAnnotations","dashboard","range","then","data","annotations","err","render","dataList","length","tmpPanelHeight","ctrl","height","row","replace","actualHeight","parseInt","renderer","isTimezoneUtc","$sanitize","get","exportTableDataToCsv","render_values","scope","elem","attrs","formatters","_this","renderPanel","panelHeight","getPanelHeight","renderData","renderingCompleted","column","without","$q","when","getColumns","segments","c","newSegment","find","plusButton","html","columnStyleDefaults","style","subItem","index","ref","templateUrl"],"mappings":"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","file":"ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport $ from 'jquery';\nimport angular from 'angular';\nimport kbn from 'app/core/utils/kbn';\n\nimport * as FileExport from 'app/core/utils/file_export';\nimport DataTable from './libs/datatables.net/js/jquery.dataTables.min.js';\n\n// this is needed for basic datatables.net theme\n//import './libs/datatables.net-dt/css/jquery.dataTables.min.css!';\n\n// See this for styling https://datatables.net/manual/styling/theme-creator\n\n/*\nDark Theme Basic uses these values\n\ntable section border: #242222 rgb(36,34,34)\nrow/cell border: #141414 rgb(20,20,20)\nrow background: #1F1D1D  rgb(31,29,29)\nrow selected color:  #242222 rgb(36,34,34)\ncontrol text: #1FB2E5 rgb(31,178,229)\ncontrol text: white  (dataTables_paginate)\npaging active button: #242222 rgb(36,34,34)\npaging button hover: #111111 rgb(17,17,17)\n\nwith these modifications:\n.dataTables_wrapper .dataTables_paginate .paginate_button {\n  color: white\n}\ntable.dataTable tfoot th {\n  color: #1FB2E5;\n  font-weight: bold; }\n\n\nLight Theme Basic uses these values\n\ntable section border: #ECECEC rgb(236,236,236)\nrow/cell border: #FFFFFF rgb(255,255,255)\nrow background: #FBFBFB  rgb(251,251,251)\nrow selected color:  #ECECEC rgb(236,236,236)\ncontrol text: black\npaging active button: #BEBEBE\npaging button hover: #C0C0C0\n\nwith these modifications:\n.dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {\n  color: #1fb2e5 !important;\ntable.dataTable tfoot th {\n  color: #1FB2E5;\n  font-weight: bold; }\n*/\n\nimport './css/panel.css!';\n// themes attempt to modify the entire page, this \"contains\" the styling to the table only\nimport './css/datatables-wrapper.css!';\n\nimport {\n    transformDataToTable,\n    transformers\n} from './transformers';\n\nimport {DatatableRenderer} from './renderer';\n\nconst panelDefaults = {\n    targets: [{}],\n    transform: 'timeseries_to_columns',\n    rowsPerPage: 5,\n    showHeader: true,\n    styles: [\n        {\n            type: 'date',\n            pattern: 'Time',\n            dateFormat: 'YYYY-MM-DD HH:mm:ss',\n        },\n        {\n            unit: 'short',\n            type: 'number',\n            decimals: 2,\n            colors: [\"rgba(245, 54, 54, 0.9)\", \"rgba(237, 129, 40, 0.89)\", \"rgba(50, 172, 45, 0.97)\"],\n            colorMode: null,\n            pattern: '/.*/',\n            thresholds: [],\n        }\n    ],\n    columns: [],\n    groupBy: [],\n    splitColumn: [],\n    splitChar: null,\n    scroll: false,\n    scrollHeight: 'default',\n    fontSize: '100%',\n    sort: {\n        col: 0,\n        desc: true\n    },\n    sortDirection: 'desc',\n    datatableTheme: 'basic_theme',\n    themeOptions: {\n        light: './css/datatable-light.css',\n        dark: './css/datatable-dark.css'\n    },\n    rowNumbersEnabled: false,\n    infoEnabled: true,\n    searchEnabled: true,\n    showCellBorders: false,\n    showRowBorders: true,\n    hoverEnabled: true,\n    orderColumnEnabled: true,\n    compactRowsEnabled: false,\n    stripedRowsEnabled: true,\n    lengthChangeEnabled: true,\n    datatablePagingType: 'simple_numbers',\n    pagingTypes: [\n        {\n            text: 'Page number buttons only',\n            value: 'numbers',\n        },\n        {\n            text: \"'Previous' and 'Next' buttons only\",\n            value: 'simple'\n        },\n        {\n            text: \"'Previous' and 'Next' buttons, plus page numbers\",\n            value: 'simple_numbers'\n        },\n        {\n            text: \"'First', 'Previous', 'Next' and 'Last' buttons\",\n            value: 'full'\n        },\n        {\n            text: \"'First', 'Previous', 'Next' and 'Last' buttons, plus page numbers\",\n            value: 'full_numbers'\n        },\n        {\n            text: \"'First' and 'Last' buttons, plus page numbers\",\n            value: 'first_last_numbers'\n        }\n    ],\n    themes: [\n        {\n            value: 'basic_theme',\n            text: 'Basic',\n            disabled: false,\n        },\n        {\n            value: 'bootstrap_theme',\n            text: 'Bootstrap',\n            disabled: true,\n        },\n        {\n            value: 'foundation_theme',\n            text: 'Foundation',\n            disabled: true,\n        },\n        {\n            value: 'themeroller_theme',\n            text: 'ThemeRoller',\n            disabled: true,\n        }\n    ],\n    responsive: {\n        enable: false,\n        hiddenColumns: []\n    },\n    editor: {\n        enable: false,\n        create: false,\n        edit: false,\n        editSingle: false,\n        remove: false,\n        removeSingle: false\n    },\n    buttons: {\n        collection: false,\n        columnsToggle: false,\n        columnsVisibility: false,\n        columnToggle: false,\n        columnVisibility: false,\n        colvis: false,\n        colvisGroup: false,\n        colvisRestore: false,\n        copy: false,\n        copyHtml5: false,\n        print: false,\n        pageLength: false,\n        csv: false,\n        csvHtml5: false,\n        excel: false,\n        excelHtml5: false,\n        pdf: false,\n        pdfHtml5: false,\n        selectAll: false,\n        selectNone: false,\n        selectCells: false,\n        selectColumns: false,\n        selectRows: false\n    }\n};\n\nexport class DatatablePanelCtrl extends MetricsPanelCtrl {\n\n    constructor($scope, $injector, $http, $location, uiSegmentSrv, annotationsSrv) {\n        super($scope, $injector);\n\n        this.pageIndex = 0;\n        this.table = null;\n        this.dataRaw = [];\n        this.transformers = transformers;\n        this.annotationsSrv = annotationsSrv;\n        this.uiSegmentSrv = uiSegmentSrv;\n        // editor\n\n        this.addColumnSegment = uiSegmentSrv.newPlusButton();\n        this.addGroupBySegment = uiSegmentSrv.newPlusButton();\n        this.addSplitSegment = uiSegmentSrv.newPlusButton();\n        this.addHiddenColumnBySegment = uiSegmentSrv.newPlusButton();\n        this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n        this.colorModes = [\n            {\n                text: 'Disabled',\n                value: null\n            },\n            {\n                text: 'Cell',\n                value: 'cell'\n            },\n            {\n                text: 'Value',\n                value: 'value'\n            },\n            {\n                text: 'Row',\n                value: 'row'\n            },\n            {\n                text: 'Row Column',\n                value: 'rowcolumn'\n            },\n        ];\n        this.columnTypes = [\n            {\n                text: 'Number',\n                value: 'number'\n            },\n            {\n                text: 'String',\n                value: 'string'\n            },\n            {\n                text: 'Date',\n                value: 'date'\n            },\n            {\n                text: 'Hidden',\n                value: 'hidden'\n            }\n        ];\n        this.unitFormats = kbn.getUnitFormats();\n        this.dateFormats = [\n            {\n                text: 'YYYY-MM-DD HH:mm:ss',\n                value: 'YYYY-MM-DD HH:mm:ss'\n            },\n            {\n                text: 'MM/DD/YY h:mm:ss a',\n                value: 'MM/DD/YY h:mm:ss a'\n            },\n            {\n                text: 'MMMM D, YYYY LT',\n                value: 'MMMM D, YYYY LT'\n            },\n        ];\n        this.sortDirections = [\"desc\", \"asc\"];\n        // this is used from bs-typeahead and needs to be instance bound\n        this.getColumnNames = () => {\n            if (!this.table) {\n                return [];\n            }\n            return _.map(this.table.columns, function (col) {\n                return col.text;\n            });\n        };\n\n        if (this.panel.styles === void 0) {\n            this.panel.styles = this.panel.columns;\n            this.panel.columns = this.panel.fields;\n            delete this.panel.columns;\n            delete this.panel.fields;\n        }\n        _.defaults(this.panel, panelDefaults);\n\n        System.config({\n            paths: {\n                \"datatables.net\": this.getPanelPath() + \"libs/datatables.net/js/jquery.dataTables.min\",\n                \"datatables.net-bs\": this.getPanelPath() + \"libs/datatables.net-bs/js/dataTables.bootstrap.min\",\n                \"datatables.net-jqui\": this.getPanelPath() + \"libs/datatables.net-jqui/js/dataTables.jqueryui.min\",\n                \"datatables.net-zf\": this.getPanelPath() + \"libs/datatables.net-zf/js/dataTables.foundation.min\",\n                \"datatables.net-responsive\": this.getPanelPath() + \"libs/datatables.net-responsive/js/dataTables.responsive.min\",\n                \"datatables.net-buttons\": this.getPanelPath() + \"libs/datatables.net-buttons/js/dataTables.buttons\"\n            }\n        });\n\n        System.import(this.getPanelPath() + 'libs/datatables.net-responsive/js/dataTables.responsive.min.js');\n        System.import(this.getPanelPath() + 'libs/datatables.net-buttons/js/dataTables.buttons.min.js');\n        System.import(this.getPanelPath() + 'libs/datatables.net-buttons/js/buttons.colVis.min.js');\n        System.import(this.getPanelPath() + 'libs/datatables.net-buttons/js/buttons.html5.min.js');\n        System.import(this.getPanelPath() + 'libs/datatables.net-buttons/js/buttons.print.min.js');\n        System.import(this.getPanelPath() + 'libs/datatables.net-select/js/dataTables.select.min.js');\n\n        // basic datatables theme\n        // alternative themes are disabled since they affect all datatable panels on same page currently\n        switch (this.panel.datatableTheme) {\n            case 'basic_theme':\n                System.import(this.getPanelPath() + 'libs/datatables.net-dt/css/jquery.dataTables.min.css!');\n                System.import(this.getPanelPath() + 'libs/datatables.net-responsive-dt/css/responsive.dataTables.min.css!');\n                System.import(this.getPanelPath() + 'libs/datatables.net-buttons-dt/css/buttons.dataTables.min.css!');\n\n                if (grafanaBootData.user.lightTheme) {\n                    System.import(this.getPanelPath() + this.panel.themeOptions.light + '!css');\n                } else {\n                    System.import(this.getPanelPath() + this.panel.themeOptions.dark + \"!css\");\n                }\n                break;\n            case 'bootstrap_theme':\n                System.import(this.getPanelPath() + 'libs/datatables.net-bs/js/dataTables.bootstrap.min.js');\n                System.import(this.getPanelPath() + 'libs/bootstrap/dist/css/prefixed-bootstrap.min.css!');\n                System.import(this.getPanelPath() + 'libs/datatables.net-bs/css/dataTables.bootstrap.min.css!');\n                if (!grafanaBootData.user.lightTheme) {\n                    System.import(this.getPanelPath() + 'css/prefixed-bootstrap-slate.min.css!');\n                }\n                break;\n            case 'foundation_theme':\n                System.import(this.getPanelPath() + 'libs/datatables.net-zf/js/dataTables.foundation.min.js');\n                System.import(this.getPanelPath() + 'libs/foundation/css/prefixed-foundation.min.css!');\n                System.import(this.getPanelPath() + 'libs/datatables.net-zf/css/dataTables.foundation.min.css!');\n                break;\n            case 'themeroller_theme':\n                System.import(this.getPanelPath() + 'libs/datatables.net-jqui/js/dataTables.jqueryui.min.js');\n                System.import(this.getPanelPath() + 'libs/datatables.net-jqui/css/dataTables.jqueryui.min.css!');\n                System.import(this.getPanelPath() + 'css/jquery-ui-smoothness.css!');\n                break;\n            default:\n                System.import(this.getPanelPath() + 'libs/datatables.net-dt/css/jquery.dataTables.min.css!');\n                if (grafanaBootData.user.lightTheme) {\n                    System.import(this.getPanelPath() + this.panel.themeOptions.light + '!css');\n                } else {\n                    System.import(this.getPanelPath() + this.panel.themeOptions.dark + \"!css\");\n                }\n                break;\n        }\n        this.dataLoaded = true;\n        this.http = $http;\n        this.events.on('data-received', this.onDataReceived.bind(this));\n        this.events.on('data-error', this.onDataError.bind(this));\n        this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n        this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n    }\n\n    onInitPanelActions(actions) {\n        actions.push({\n            text: 'Export CSV',\n            click: 'ctrl.exportCsv()'\n        });\n    }\n\n    // setup the editor\n    onInitEditMode() {\n        // determine the path to this plugin\n        var panels = grafanaBootData.settings.panels;\n        var thisPanel = panels[this.pluginId];\n        var thisPanelPath = thisPanel.baseUrl + '/';\n        // add the relative path to the partial\n        var optionsPath = thisPanelPath + 'partials/editor.options.html';\n        this.addEditorTab('Options', optionsPath, 2);\n        var datatableOptionsPath = thisPanelPath + 'partials/datatables.options.html';\n        this.addEditorTab('Datatable Options', datatableOptionsPath, 3);\n    }\n\n    getPanelPath() {\n        var panels = grafanaBootData.settings.panels;\n        var thisPanel = panels[this.pluginId];\n        // the system loader preprends publib to the url, add a .. to go back one level\n        var thisPanelPath = '../' + thisPanel.baseUrl + '/';\n        return thisPanelPath;\n    }\n\n    issueQueries(datasource) {\n        this.pageIndex = 0;\n        if (this.panel.transform === 'annotations') {\n            this.setTimeQueryStart();\n            return this.annotationsSrv.getAnnotations({\n                dashboard: this.dashboard,\n                panel: this.panel,\n                range: this.range\n            })\n                .then(annotations => {\n                    return {\n                        data: annotations\n                    };\n                });\n        }\n        return super.issueQueries(datasource);\n    }\n\n    onDataError(err) {\n        this.dataRaw = [];\n        this.render();\n    }\n\n    onDataReceived(dataList) {\n        this.dataRaw = dataList;\n        this.pageIndex = 0;\n\n        // automatically correct transform mode based on data\n        if (this.dataRaw && this.dataRaw.length) {\n            if (this.dataRaw[0].type === 'table') {\n                this.panel.transform = 'table';\n            } else {\n                if (this.dataRaw[0].type === 'docs') {\n                    this.panel.transform = 'json';\n                } else {\n                    if (this.panel.transform === 'table' || this.panel.transform === 'json') {\n                        this.panel.transform = 'timeseries_to_rows';\n                    }\n                }\n            }\n        }\n        this.render();\n    }\n\n    render() {\n        this.table = transformDataToTable(this.dataRaw, this.panel);\n        this.table.sort(this.panel.sort);\n        return super.render(this.table);\n    }\n\n    getPanelHeight() {\n        // panel can have a fixed height via options\n        var tmpPanelHeight = this.$scope.ctrl.panel.height;\n        // if that is blank, try to get it from our row\n        if (typeof tmpPanelHeight === 'undefined') {\n            // get from the row instead\n            tmpPanelHeight = this.row.height;\n            // default to 250px if that was undefined also\n            if (typeof tmpPanelHeight === 'undefined') {\n                tmpPanelHeight = 250;\n            }\n        }\n        else {\n            // convert to numeric value\n            tmpPanelHeight = tmpPanelHeight.replace(\"px\", \"\");\n        }\n        var actualHeight = parseInt(tmpPanelHeight);\n        // grafana minimum height for a panel is 250px\n        if (actualHeight < 250) {\n            actualHeight = 250;\n        }\n        return actualHeight;\n    }\n\n    exportCsv() {\n        var renderer = new DatatableRenderer(this.panel, this.table, this.dashboard.isTimezoneUtc(), this.$sanitize, this.$injector.get('linkSrv'));\n        FileExport.exportTableDataToCsv(renderer.render_values());\n    }\n\n    link(scope, elem, attrs, ctrl) {\n        var data;\n        var panel = ctrl.panel;\n        var formatters = [];\n        var _this = this;\n\n        /**\n         * [renderPanel description]\n         * @return {[type]} [description]\n         */\n        function renderPanel() {\n            var renderer = new DatatableRenderer(panel, ctrl.table, ctrl.dashboard.isTimezoneUtc(), ctrl.$sanitize, ctrl.$injector.get('linkSrv'));\n            renderer.render();\n            _this.dataLoaded = true;\n        }\n\n        ctrl.panel.panelHeight = this.getPanelHeight();\n        ctrl.events.on('render', function (renderData) {\n            data = renderData || data;\n            if (data) {\n                renderPanel();\n            }\n            ctrl.renderingCompleted();\n        });\n    }\n\n    // editor methods\n    //\n    // cell and row borders cannot both be set at the same time\n    showCellBordersChanged() {\n        if (this.panel.showCellBorders) {\n            this.panel.showRowBorders = false;\n        }\n        this.render();\n    }\n\n    themeChanged() {\n        //console.log(this.panel.datatableTheme);\n        this.render();\n    }\n\n    transformChanged() {\n        this.panel.columns = [];\n        this.panel.groupBy = [];\n        this.panel.splitColumn = [];\n        this.render();\n    }\n\n    removeColumn(column) {\n        this.panel.columns = _.without(this.panel.columns, column);\n        this.render();\n    }\n\n    removeGroupBy(column) {\n        this.panel.groupBy = _.without(this.panel.groupBy, column);\n        this.render();\n    }\n\n    removeSplitColumn(column) {\n        this.panel.splitColumn = _.without(this.panel.splitColumn, column);\n        this.render();\n    }\n\n    removeHiddenColumns(column) {\n        this.panel.responsive.hiddenColumns = _.without(this.panel.responsive.hiddenColumns, column);\n        this.render();\n    }\n\n    getColumnOptions() {\n        if (!this.dataRaw) {\n            return this.$q.when([]);\n        }\n        var columns = this.transformers[this.panel.transform].getColumns(this.dataRaw);\n        var segments = _.map(columns, (c) => this.uiSegmentSrv.newSegment({\n            value: c.text\n        }));\n        return this.$q.when(segments);\n    }\n\n    addColumn() {\n        var columns = transformers[this.panel.transform].getColumns(this.dataRaw);\n        var column = _.find(columns, {\n            text: this.addColumnSegment.value\n        });\n\n        if (column) {\n            this.panel.columns.push(column);\n\n        } else {\n            this.panel.columns.push({text: this.addColumnSegment.value, value: this.addColumnSegment.value});\n        }\n        this.render();\n\n        var plusButton = this.uiSegmentSrv.newPlusButton();\n        this.addColumnSegment.html = plusButton.html;\n        this.addColumnSegment.value = plusButton.value;\n    }\n\n    addGroupBy() {\n        var columns = transformers[this.panel.transform].getColumns(this.dataRaw);\n        var column = _.find(columns, {\n            text: this.addGroupBySegment.value\n        });\n\n        if (column) {\n            this.panel.groupBy.push(column);\n            this.render();\n        }\n\n        var plusButton = this.uiSegmentSrv.newPlusButton();\n        this.addGroupBySegment.html = plusButton.html;\n        this.addGroupBySegment.value = plusButton.value;\n    }\n\n    addSplitColumn() {\n        var columns = transformers[this.panel.transform].getColumns(this.dataRaw);\n        var column = _.find(columns, {\n            text: this.addSplitSegment.value\n        });\n\n        if (column) {\n            this.panel.splitColumn.push(column);\n            this.render();\n        }\n\n        var plusButton = this.uiSegmentSrv.newPlusButton();\n        this.addSplitSegment.html = plusButton.html;\n        this.addSplitSegment.value = plusButton.value;\n    }\n\n    addHiddenColumn() {\n        var columns = transformers[this.panel.transform].getColumns(this.dataRaw);\n        var column = _.find(columns, {\n            text: this.addHiddenColumnBySegment.value\n        });\n\n        if (column) {\n            this.panel.responsive.hiddenColumns.push(column);\n            this.render();\n        }\n\n        var plusButton = this.uiSegmentSrv.newPlusButton();\n        this.addHiddenColumnBySegment.html = plusButton.html;\n        this.addHiddenColumnBySegment.value = plusButton.value;\n    }\n\n    addColumnStyle() {\n        var columnStyleDefaults = {\n            unit: 'short',\n            type: 'number',\n            decimals: 2,\n            colors: [\"rgba(245, 54, 54, 0.9)\", \"rgba(237, 129, 40, 0.89)\", \"rgba(50, 172, 45, 0.97)\"],\n            colorMode: null,\n            pattern: '/.*/',\n            dateFormat: 'YYYY-MM-DD HH:mm:ss',\n            thresholds: [],\n        };\n        this.panel.styles.push(angular.copy(columnStyleDefaults));\n    }\n\n    removeColumnStyle(style) {\n        this.panel.styles = _.without(this.panel.styles, style);\n    }\n\n    setUnitFormat(column, subItem) {\n        column.unit = subItem.value;\n        this.render();\n    }\n\n    invertColorOrder(index) {\n        var ref = this.panel.styles[index].colors;\n        var copy = ref[0];\n        ref[0] = ref[2];\n        ref[2] = copy;\n        this.render();\n    }\n}\n\nDatatablePanelCtrl.templateUrl = 'partials/template.html';\n"]}